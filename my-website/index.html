<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChillFlix Real-Time Visitors</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <style>
    #visitor-stats-box {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: linear-gradient(135deg, #ff1e56, #1e90ff);
      color: #fff;
      padding: 16px 20px;
      border-radius: 16px;
      font-family: 'Segoe UI', sans-serif;
      font-size: 14px;
      box-shadow: 0 0 16px rgba(255, 0, 70, 0.6), 0 0 16px rgba(30, 144, 255, 0.6);
      z-index: 9999;
      display: flex;
      align-items: center;
      gap: 14px;
      animation: pulse 2s infinite;
    }
    #visitor-stats-box img {
      border-radius: 8px;
      width: 30px;
      height: 30px;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 16px rgba(255, 0, 70, 0.5), 0 0 16px rgba(30, 144, 255, 0.5); }
      50% { box-shadow: 0 0 24px rgba(255, 0, 70, 0.8), 0 0 24px rgba(30, 144, 255, 0.8); }
      100% { box-shadow: 0 0 16px rgba(255, 0, 70, 0.5), 0 0 16px rgba(30, 144, 255, 0.5); }
    }
  </style>
</head>
<body>

  <!-- Visitor Box -->
  <div id="visitor-stats-box">
    <img src="chillflix-logo.png" alt="ChillFlix Logo" />
    <div id="visitor-stats">Detecting your country...</div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js"></script>

  <script>
    // Your Firebase config (replace with your actual config)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID",
      measurementId: "YOUR_MEASUREMENT_ID"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Detect user country and track user in Firebase
    fetch('https://ipapi.co/json/')
      .then(res => res.json())
      .then(data => {
        const country = data.country_name || 'Unknown';
        const userRef = db.ref("activeUsers").push();

        // Add current user with country and timestamp
        userRef.set({
          country: country,
          timestamp: Date.now()
        });

        // Remove user from DB on disconnect
        userRef.onDisconnect().remove();

        // Listen to all active users data
        db.ref("activeUsers").on("value", snapshot => {
          const users = snapshot.val();
          const totalUsers = users ? Object.keys(users).length : 0;
          const countriesSet = new Set();

          for (const key in users) {
            if (users[key].country) {
              countriesSet.add(users[key].country);
            }
          }

          document.getElementById('visitor-stats').innerHTML = `
            üë§ <strong>You</strong> are from <strong>${country}</strong><br>
            üßë <strong>${totalUsers}</strong> user${totalUsers !== 1 ? 's' : ''} online<br>
            üåç From <strong>${countriesSet.size}</strong> countr${countriesSet.size !== 1 ? 'ies' : 'y'}
          `;
        });
      })
      .catch(() => {
        document.getElementById('visitor-stats').textContent = "Could not detect your country.";
      });
  </script>
</body>
</html>



